From 3d34033a90eb3a9352150e5d16d40e0268df20a7 Mon Sep 17 00:00:00 2001
From: vgdn1942 <vgdn1942@gmail.com>
Date: Mon, 15 Nov 2021 09:00:07 +0300
Subject: [PATCH 45/80] Add keylayout for Blackview BV9500Plus

---
 base.mk                     | 1 +
 files/bv9500plus-mtk-kpd.kl | 5 +++++
 rw-system.sh                | 6 ++++++
 3 files changed, 12 insertions(+)
 create mode 100644 files/bv9500plus-mtk-kpd.kl

diff --git a/base.mk b/base.mk
index 27d3767..0c0044d 100644
--- a/base.mk
+++ b/base.mk
@@ -148,6 +148,7 @@ PRODUCT_COPY_FILES += \
 	device/phh/treble/files/zf6-goodixfp.kl:system/phh/zf6-goodixfp.kl \
 	device/phh/treble/files/zf6-googlekey_input.kl:system/phh/zf6-googlekey_input.kl \
 	device/phh/treble/files/teracube2e-mtk-kpd.kl:system/phh/teracube2e-mtk-kpd.kl \
+	device/phh/treble/files/bv9500plus-mtk-kpd.kl:system/phh/bv9500plus-mtk-kpd.kl \
 
 SELINUX_IGNORE_NEVERALLOWS := true
 
diff --git a/files/bv9500plus-mtk-kpd.kl b/files/bv9500plus-mtk-kpd.kl
new file mode 100644
index 0000000..724fb50
--- /dev/null
+++ b/files/bv9500plus-mtk-kpd.kl
@@ -0,0 +1,5 @@
+key 114   VOLUME_DOWN
+key 115   VOLUME_UP
+key 116   POWER
+key 249   ASSIST
+key 250   CAMERA
diff --git a/rw-system.sh b/rw-system.sh
index 424173c..769768f 100644
--- a/rw-system.sh
+++ b/rw-system.sh
@@ -275,6 +275,12 @@ changeKeylayout() {
         changed=true
     fi
 
+    if getprop ro.vendor.build.fingerprint | grep -q -i -e Blackview/BV9500Plus;then
+        cp /system/phh/bv9500plus-mtk-kpd.kl /mnt/phh/keylayout/mtk-kpd.kl
+        chmod 0644 /mnt/phh/keylayout/mtk-kpd.kl
+        changed=true
+    fi
+
     if [ "$changed" = true ]; then
         mount -o bind /mnt/phh/keylayout /system/usr/keylayout
         restorecon -R /system/usr/keylayout
-- 
2.25.1

